---
title: "secuTrialR - a walk through"
author: "Patrick R. Wright"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{secuTrialR-package-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

> “If I had just five minutes to chop down a tree I would spend the first two and a half minutes sharpening my axe.”

> `r tufte::quote_footer('--- An anonymous woodsman')`

# Introduction

This R package provides functions for handling data from the clinical data management system (CDMS) 
[\textcolor{blue}{secuTrial}](https://www.secutrial.com/en/).
The most important components are related to reading data exports from secuTrial into R. In brief, the package
aims to enable swift execution of repetitive tasks in order to allow spending more time on the unique aspects
of a dataset. It is developed and maintained by the Swiss Clinical Trial Organisation ([\textcolor{blue}{SCTO}](https://www.scto.ch/en/news.html)).

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Installing

Lets get started by installing the package straight from 
[\textcolor{blue}{GitHub}](https://github.com/SwissClinicalTrialOrganisation/secuTrialR)
and then loading it. For this you will need to have `devtools` installed.
\vspace{5pt}

```{r, eval = FALSE}
# install
devtools::install_github("SwissClinicalTrialOrganisation/secuTrialR")
# load
library(secuTrialR)
```

# The CTU05 dataset

Before we continue with the functionalities lets briefly talk about the test data which is
delivered as a part of the package. We refer to it as the `CTU05` (clinical trial unit project 05) data.
This dataset has been fabricated for demonstrarion purposes only and is not real clinical data.
Principally it is made up of eight forms. These are called "surgeries", "baseline", "outcome", 
"treatment", "allmedi", "studyterminat", "ae" and "sae". You will see these names again later when 
the data has been read into R.
The project setup includes most data types implementable in secuTrial. It is, however, not exhaustive.
Since it is delivered with the installation of the `secuTrialR` package we can point to it via the
`system.file()` function. 
\vspace{5pt}

```{r}
ctu05_data_location <- system.file("extdata", "sT_exports", "export_options",
                                   "s_export_CSV-xls_CTU05_20191003-144349_all_info.zip",
                                   package = "secuTrialR")
```

If you work with `secuTrialR` on your own data sets you can specify a path without using `system.file()`.

\newpage

# secuTrial data export options

Before reading your data into R you need to export it with the secuTrial ExportSearchTool.
We suggest exporting **non rectangular**, **zipped**, **English** data with 
**reference values** stored **in a separate table** including 
**Add-IDs**, **centre information**, **form status**, **project setup**
and **without duplicated meta data**. Furthermore it is suggested to use
**UTF-8** encoding and **"CSV format"**/**"CSV format for MS Excel"**.
Most of these options are truly optional and reading your data should
work even with differences from the above specifications.

# Reading a secuTrial data export into R

There is one princtiple way to read your data. You should use `read_secuTrial()`.
Below you can see it in action with the `CTU05` dataset.
\vspace{5pt}

```{r}
ctu05_data <- read_secuTrial(data_dir = ctu05_data_location)
```

If the "Read export successfully." message appears your data was correctly read.

# The secuTrialdata object

If you inspect the `class()` of `ctu05_data` you will find that it is a `secuTrialdata` object.
\vspace{5pt}

```{r}
class(ctu05_data)
```

Really this is only a list containing all the information from your secuTrial export.

```{r}
typeof(ctu05_data)
```

We have implemented a variation of the `print()` function for `secuTrialdata` objects.
